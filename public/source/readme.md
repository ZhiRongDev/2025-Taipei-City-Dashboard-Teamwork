# 提案動機與說明
面對極端氣候與高密度城市發展交錯帶來的災害風險，都市居民對防災設施的需求日益迫切。特別是在雙北地區，人口集中且地理條件複雜，各行政區防空疏散避難設施、緊急救助資源（如 AED、消防、警政等）是否足夠且分布合理，將直接影響應變效率與公共安全。為此，我們提出本提案，致力於建立一套結合人口統計與空間分布視覺化的防災資源分析系統，協助政策制定者盤點資源配置，並提升全民防災韌性。

## 計畫主題與模組設計
本提案聚焦於三大主題，並以模組化設計方式建構分析介面：

區域人口與防災資源比分析
結合鄉鎮市區人口統計與防災資源（包含防空疏散設施、避難收容處所、AED 及消防/警政據點）進行比對，針對數量、人均數量與地點離散度等指標，分析各區的防災資源密度。分析模組涵蓋地圖視覺化、雙北橫向比較與行政區排序圖表。

離散度分析指標設計
為衡量防災設施於各區域內的分布情況，採用兩種空間離散度指標：

平均兩兩距離 (Dispersion)：計算各設施間的歐氏距離平均，反映地理上分散程度。

空間熵 (Spatial Entropy)：透過網格分佈與資訊熵公式，分析設施分布的隨機性與集中性。

兩種方法互為補充，能夠從距離與型態兩個維度評估資源分布狀況。

人口比值指標
透過區域人口與戶數對資源數量的比值計算（例如每個設施平均服務多少人或戶），以人口需求導向來衡量設施負荷。

雙北防空疏散避難設施分析
將防空避難設施進行空間與容量交叉評估，包括設施面積、總容納人數與人均收容空間，以矩形圖形式直觀呈現，協助判斷哪些地區設施壓力較高、分布較擁擠。

旅遊景點周邊防災設施分析
考量旅遊景點常為高人流熱區，若發生災害將對救援效率構成挑戰，因此本主題針對觀光景點 1km、5km 與 10km 範圍內防災設施（包含 AED、避難所、警消單位等）進行 haversine 距離分析，盤點其應變能力與資源覆蓋程度。

## 資料處理流程與完整性
本計畫資料處理共分三階段，確保資料一致性與後續分析品質：

Step 1. 初步清整資料
整合各類型資料來源，包括：

鄉鎮市區人口統計與 geojson 空間圖層。

各項防災資源清單（AED、防空疏散設施、避難收容處、消防與警政據點）。

月度觀光景點人流資料。

Step 2. 跨資料整合
將所有防災資源點位合併為統一資料表，並加入經緯度欄位，作為空間分析基礎。

Step 3. 主題專屬資料生成
根據三個主題目的，產出對應的統計表：

各行政區的防災資源數量、人均比例、離散度。

避難所人均收容面積。

旅遊景點周邊的防災資源分布分析表。

## 預期效益
透過本提案的資料整合與視覺分析系統，我們將可：

建立防災資源公平性與可近性的量化依據。

發掘高風險區域與潛在資源缺口。

支援政府進行資源優化配置與應變演練規劃。

提升民眾對居住地與旅遊地防災能力的理解與警覺。

# 資料說明
## step1: 初步清整資料 (clean)
- clean\merged_population.csv: 鄉鎮市區人口年度統計資料
- clean\spot_flow_month.csv: 景點人每月流資料
- clean\town.geojson: 鄉鎮市區 geojson 屬性 
    - 屬性
        - 'INFO_TIME': 資料時間
        - 'COUNTY_ID': 縣市代碼
        - 'COUNTY': 縣市名稱
        - 'TOWN_ID': 鄉鎮市區代碼
        - 'TOWN': 鄉鎮市區名稱
        - 'H_CNT': 戶數
        - 'P_CNT': 人口數
        - 'M_CNT': 男性人口數
        - 'F_CNT': 女性人口數
- clean\AED_list.csv: AED 清單
- clean\消防局資源_Resource.csv: 防災單位(警察、消防、義消)
- clean\消防局資源_Resource_FillCoordinate: 防災單位(警察、消防、義消) + 經緯度
- clean\防空疏散合併.csv: 防空疏散地
- clean\避難收容處所合併.csv: 避難收容處所



## step2: 跨資合併 (merge) 
- merge\town_coordinates_list.csv: 合併所有防災相關資原點資訊(AED、防災單位(警察、消防、義消)、防空疏散地、避難收容處所)，方便後續做使用。


## step3: 針對 Topic 生成資料 
### Topic 1: 區域人口與防災資源比
- topic1_regional_discrete_count(XXX).csv: 包含 AED、防空疏散地、避難收容處所、防災單位各自的鄉鎮市區統計數量、離散程度與 113 年區域人口比值
    - 離散程度有兩種計算方法:
        1. 平均兩兩距離 (Dispersion)
            - 方法描述： 使用 scipy.spatial.distance.pdist 計算一個地區內所有地點（經緯度）間的兩兩歐氏距離（Euclidean distance），然後取平均。
            - 數學意義：衡量地點彼此之間的「平均距離」，反映的是這些地點在空間上的分散程度。距離越大，表示區域內的地點越分散。
            - 優點：直觀、具可解釋性。適合用來反映「實際距離上的分散」。
            - 限制：對群體數量敏感（樣本數越多，平均距離可能越穩定）。不一定能捕捉到地點分布的形狀或隨機性（例如集中在一條線上或四散分布）。
            
        2. 空間熵 (Spatial Entropy)
            - 方法描述：自訂函式 spatial_entropy 使用格網法（grid-based method）：將經緯度範圍各自等分為 10 個區間（形成 10x10 的格子）。將每個地點落入相對應的格子中。統計每個格子的點數，計算分布的機率 p。
            - 使用熵的公式：
                - entropy = -sum(p * log(p)) 計算總熵值。
            - 數學意義：
                - 熵越高，表示點分布越均勻或隨機；熵越低，則表示有集中或群聚現象。
            - 優點：
                - 可以反映出點在區域內分布的「隨機性」或「均勻性」。相對不太受單點間距離影響，更注重點的分布型態。
            - 限制：
                - 對格子數目敏感（太少或太多都會扭曲結果）。無法反映具體距離（僅關注分布機率）。
        - 比較
            | 特徵     | 平均兩兩距離 (Dispersion) | 空間熵 (Spatial Entropy) |
            | ------ | ------------------- | --------------------- |
            | 描述方式   | 平均距離                | 分布熵值                  |
            | 反映面向   | 點之間的實際分散程度          | 點的隨機性與均勻性             |
            | 適合場景   | 分析距離或範圍             | 分析分布型態或集中性            |
            | 數值越大代表 | 越分散                 | 越均勻 / 越隨機             |
            | 演算法複雜度 | 中等（計算距離矩陣）          | 低（統計分布）               |
    - 人口比值包含 households_per_count(區域戶數/區域數量) 與 population_per_count(區域人數/區域數量)
### Topic 2: 避難所人均面積
- topic\taipei\topic2-1__Town__asylum__pol_land_rate.csv

### Topic 3: 景點周遭距離

- topic_3-1_spot_source_count_in__10km.csv: 使用 haversine 距離計算每個景點與防災資源總表的經位度距離，分別篩選出 1km、5km、10km 周圍防災資源資訊

# 資料來源
1. 鄉鎮市區人口統計資料(僅使用113Y12M)-https://segis.moi.gov.tw/STATCloud/QueryInterface?DV=4 
     (類別:人口 | 地區: 全國 | 空間統計單元: 鄉鎮市區|)
2. 鄉鎮市區圖層-https://segis.moi.gov.tw/STATCloud/QueryInterface?DV=4) 
     (類別:人口 | 地區: 全國 | 空間統計單元: 鄉鎮市區|)
3. 新北市防空疏散避難設施數量及容量-https://data.gov.tw/dataset/123701 
4. 臺北市防空疏散避難設施資料集-https://data.gov.tw/dataset/151681
5. 新北市避難收容處所一覽表-https://data.gov.tw/dataset/125800
6. 臺北市可供避難收容處所一覽表-https://data.gov.tw/dataset/134683
7. AED位置資訊 (全國)-https://data.gov.tw/dataset/12063 
8 救災資源資料清單(包含警消單位)-https://data.gov.tw/dataset/77862 
9. 歷年國內主要觀光遊憩據點遊客人數月別統計(僅使用景點資訊)-https://data.gov.tw/dataset/8116

